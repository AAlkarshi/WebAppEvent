{% extends 'base.html.twig' %}

{% block title %}{{ event.titleEvent }}{% endblock %}

{% block body %}
<section class="event-container">
    <!-- COLONNE GAUCHE : IMAGE DE L'ÉVÉNEMENT -->
    <div class="ColonneGauche">
        {% if event.imageEvent %}
            <img src="{{ asset('uploads/events/' ~ event.imageEvent) }}" alt="{{ event.titleEvent }}" class="event-image">
        {% else %}
            <img src="{{ asset('uploads/events/default.png') }}" alt="Image par défaut" class="event-image">
        {% endif %}
    </div>

    <!-- COLONNE DROITE : INFOS DE L'ÉVÉNEMENT -->
    <div class="event-grid">
        <div class="profile-container">
            <h1>{{ event.titleEvent }}</h1>

            {% if event.category %}
                <p class="event-info"><strong>Catégorie :</strong> {{ event.category.nameCategory }}</p>
            {% endif %}

            <p class="event-info"><strong>Date :</strong> {{ event.dateTimeEvent|date('d/m/Y H:i') }}</p>

            {% if event.address %}
                <p class="event-info"><strong>Adresse :</strong> {{ event.address.address }}, {{ event.address.city }} ({{ event.address.cp }})</p>
            {% endif %}

            {% if event.descriptionEvent %}
                <p class="event-description">{{ event.descriptionEvent }}</p>
            {% endif %}

            <h3>Participants ({{ activeCount > 0 ? activeCount : 1 }})</h3>

            {% if activeCount > 0 %}
                {% if isRegistered %}
                    <ul class="participants-list">
                        {% for reg in registers %}
                            <li>
                                <span class="participant-name">{{ reg.user.firstnameUser }} {{ reg.user.lastnameUser }}</span>
                                {% if not reg.active %}
                                    <span class="text-muted">(désinscrit)</span>
                                {% endif %}
                            </li>
                        {% else %}
                            <li>Aucun participant pour cet événement.</li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p>Seuls les participants inscrits peuvent voir la liste des participants.</p>
                {% endif %}
            {% else %}
                <ul class="participants-list">
                  {{ event.createdBy.firstnameUser }} {{ event.createdBy.lastnameUser }}  (créateur)</li>
                </ul>
            {% endif %}

            <p><a href="{{ path('app_events') }}" class="btn-submit">⬅ Retour aux événements</a></p>
        </div>
    </div>
</section>

<style>
/* --- CONTENEUR GLOBAL --- */
.event-container {
    display: flex;
    justify-content: space-between;
    align-items: stretch;
    width: 100%;
    min-height: 100vh;
    padding: 0;
    box-sizing: border-box;
}

/* --- COLONNE GAUCHE : IMAGE GRANDE --- */
.ColonneGauche {
    width: 50%;
    background-color: #003f66;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    border-radius: 0 10px 10px 0;
}

.event-image {
    width: 100%;
    height: 100vh;
    object-fit: cover;
    border-radius: 0;
}

/* --- COLONNE DROITE : INFOS --- */
.event-grid {
    width: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 50px;
}

.profile-container {
    max-width: 600px;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.profile-container h1 {
    font-size: 2.4rem;
    color: #003f66;
    margin-bottom: 15px;
}

.event-info {
    font-size: 1.2rem;
    line-height: 1.6;
}

.event-description {
    font-size: 1.1rem;
    color: #444;
    line-height: 1.6;
    background-color: #f8f8f8;
    padding: 15px;
    border-radius: 10px;
}

/* --- LISTE DES PARTICIPANTS --- */
.participants-list {
    list-style: none;
    padding: 0;
    font-size: 1.1rem;
}

.participants-list li {
    margin-bottom: 10px;
}

.participant-name {
    font-weight: bold;
}

/* --- BOUTON --- */
.btn-submit {
    background-color: #005791;
    color: white;
    padding: 12px 25px;
    font-size: 1.1rem;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.3s;
    width: fit-content;
}

.btn-submit:hover {
    background-color: #003f66;
}

/* --- RESPONSIVE --- */
@media (max-width: 768px) {
    .event-container {
        flex-direction: column;
        height: auto;
    }

    .ColonneGauche, .event-grid {
        width: 100%;
    }

    .event-image {
        height: 50vh;
    }

    .profile-container h1 {
        font-size: 2rem;
    }

    .event-info, .event-description {
        font-size: 1rem;
    }
}
</style>
{% endblock %}
